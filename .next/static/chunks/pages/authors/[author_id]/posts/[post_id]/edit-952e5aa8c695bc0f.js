(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[775],{37838:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/authors/[author_id]/posts/[post_id]/edit",function(){return i(35574)}])},35574:function(e,t,i){"use strict";i.r(t),i.d(t,{__N_SSP:function(){return E}});var n=i(28598),s=i(82684),a=i(51774),r=i.n(a),l=i(33354),o=i(7099),c=i(64645),d=i(1887),m=i.n(d),u=i(76697),x=i(81360),p=i(42413),h=i(38884),g=i(75367),v=i(16598),b=i(80018),j=i(34376),w=i(48497);let y=r()(()=>i.e(518).then(i.bind(i,86518)),{loadableGenerated:{webpack:()=>[86518]},ssr:!1}),_=e=>{let{post:t,postId:i,authorId:a}=e,[r,d]=(0,s.useState)(t.contentType),[_,E]=(0,s.useState)("text/markdown"===t.contentType?t.content:void 0),N=(0,g.cI)({defaultValues:{title:t.title,description:t.description,categories:t.categories.join(","),contentType:t.contentType,visibility:t.visibility?"PUBLIC":t.unlisted?"UNLISTED":"PRIVATE",content:t.content}});(0,h.useSupabaseClient)(),(0,h.useUser)();let f=(0,j.useRouter)(),P=async e=>{"text/markdown"===e.contentType?e.content=_:"image/*"===e.contentType&&(e.content=await (0,v.y)(e.contentFile[0])),e.contentFile&&delete e.contentFile,e.categories=e.categories.split(",");try{let t={...e,source:w.env.NEXT_PUBLIC_BASE_URL||"http://localhost:3000",origin:w.env.NEXT_PUBLIC_BASE_URL||"http://localhost:3000",unlisted:"UNLISTED"===e.visibility,visibility:e.visibility};await b.Z.updatePost(a,i,t)&&await b.Z.alertNewPost(a,t),console.log("/authors/".concat(a,"/posts/").concat(i)),await f.push("/authors/".concat(a,"/posts/").concat(i))}catch(e){console.log(e)}};return(0,n.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,n.jsx)(m(),{children:(0,n.jsx)("title",{children:"Edit Post"})}),(0,n.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,n.jsx)(x.Z,{}),(0,n.jsx)("div",{className:"overflow-y-auto w-full py-12",children:(0,n.jsx)(g.RV,{...N,children:(0,n.jsxs)("form",{className:"max-w-5xl mx-auto px-8",onSubmit:N.handleSubmit(P),children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-5",children:"Edit Post"}),(0,n.jsx)(o.Z,{register:N.register,extraClass:"mb-6",id:"title",name:"Title",placeholder:"Enter a title",required:!0}),(0,n.jsx)(l.Z,{register:N.register,id:"description",name:"Description",placeholder:"Enter a description"}),(0,n.jsx)(p.Z,{register:N.register,id:"contentType",name:"Post Type",value:r,setValue:d,options:[{name:"Markdown",value:"text/markdown"},{name:"Plain Text",value:"text/plain"},{name:"Image",value:"image/*"},{name:"Image Link",value:"image/link"}]}),(0,n.jsxs)("div",{className:"mb-2",children:["image/*"===r&&(0,n.jsx)(u.Z,{register:N.register,id:"contentFile"}),"image/link"===r&&(0,n.jsx)(o.Z,{register:N.register,extraClass:"mb-6",id:"content",name:"Image Link",placeholder:"Enter an image link"}),"text/markdown"===r&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(y,{style:{minWidth:480},value:_,onChange:E})}),"text/plain"===r&&(0,n.jsx)(l.Z,{register:N.register,id:"content",name:"Content",placeholder:"Enter content"})]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)(o.Z,{register:N.register,extraClass:"mb-4",id:"categories",name:"Categories",placeholder:"Enter categories, seperated via comma. ",required:!0}),(0,n.jsx)("span",{className:"block text-sm font-medium text-gray-900 dark:text-white",children:"Post Visibility"}),(0,n.jsx)(p.Z,{register:N.register,id:"visibility",name:"Post Visibility",options:[{name:"Public",value:"PUBLIC"},{name:"Private",value:"PRIVATE"},{name:"Unlisted",value:"UNLISTED"}]})]}),(0,n.jsx)(c.Z,{name:"Edit Post",className:"text-white"})]})})})]})]})};var E=!0;t.default=_}},function(e){e.O(0,[434,436,531,632,18,367,774,888,179],function(){return e(e.s=37838)}),_N_E=e.O()}]);